\section{Conclusion}

\co{Pymablock's algorithm combines advantages of other perturbation theory methods.}
We developed an algorithm for constructing an effective Hamiltonian that combines advantages of different perturbative expansions.
The main building block of our approach is a set of recurrence relations that define several series that depend on each other and combine into the effective Hamiltonian.
Our algorithm constructs the same effective Hamiltonians as the Schrieffer--Wolff transformation~\cite{Schrieffer_1966} in the case of $2$ subspaces, while keeping the linear scaling per extra order similar to the density matrix perturbation theory~\cite{McWeeny_1962, Truflandier_2020} or the non-orthogonal perturbation theory~\cite{Bloch_1958}.
Its expressions minimize the number of matrix multiplications per order, making it appealing both for symbolic and numerical computations.
Pymablock's algorithm is more general than any other perturbation theory method we are aware of, because it performs multi-block diagonalization and selective diagonalization with a single algorithm.

\co{The package provides a universal interface that handles constructing effective models in all quantum mechanical systems.}
We provide a Python implementation of the algorithm in the Pymablock package~\cite{Araya_2024}.
The package is thoroughly tested (95\% test coverage as of version 2.1), becoming a reliable tool for constructing effective Hamiltonians that combine multiple perturbations to high orders.
The core of the Pymablock interface is the \mintinline{python}|BlockSeries| class that handles arbitrary objects as long as they support algebraic operations.
This enables Pymablock's construction of effective models for large tight-binding models using its implicit method as well as for second quantized Hamiltonians upon providing a custom Sylvester equation solver.
It also allows Pymablock to solve both symbolic and numerical problems in diverse physical settings, and potentially to incorporate it into existing packages, such as scqubits~\cite{Groszkowski_2021}, QuTiP~\cite{Johansson_2012,Johansson_2013}, or dft2kp~\cite{Cassiano_2024}.

\co{The package provides a foundation to implement other perturbative expansions.}
Beyond the Schrieffer--Wolff transformation, the Pymablock package provides a foundation for defining other perturbative expansions.
We anticipate extending it to time-dependent problems, where the different regimes of the time-dependent drive modify the recurrence relations that need to be solved~\cite{Rodriguez-Vega_2018,Malekakhlagh_2020}.
Applying the same framework to problems with weak position dependence would allow to construct a nonlinear response theory of quantum materials.
These two extensions are active areas of research~\cite{Motzoi_2009,Bernevig_2021,Theis_2018,Venkatraman_2022,Xu_2024b, Reascos_2024}.
Finally, we expect that in the many-particle context the same framework supports implementing different flavors of diagrammatic expansions.
